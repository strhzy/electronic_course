{% extends 'base.html' %}
{% block title %}–ö–∞—Ç–µ–≥–æ—Ä–∏–∏{% endblock %}
{% block content %}
    <div class="container-md">
        <div class="row mb-4">
            <div class="col-md-6">
                {% if product.photo %}
                    <img src="{{ product.photo.url }}" class="img-fluid rounded" alt="{{ product.name|escape }}" style="max-height: 400px; object-fit: contain;">
                {% else %}
                    <img src="https://via.placeholder.com/400" class="img-fluid rounded" alt="–ù–µ—Ç —Ñ–æ—Ç–æ">
                {% endif %}
            </div>
            <div class="col-md-6">
                <h1 class="mb-3">{{ product.name }}</h1>
                <p class="lead">{{ product.description|default:"–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è" }}</p>
                <h3>{{ product.price }} ‚ÇΩ</h3>
                <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ product.category.name }}</p>
                <p><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:</strong> {{ product.manufacturer.name|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</p>
                <p><strong>–ù–∞–ª–∏—á–∏–µ:</strong> {% if product.is_exists %}–í –Ω–∞–ª–∏—á–∏–∏{% else %}–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏{% endif %}</p>
                {% if request.user.is_authenticated %}
                    <form method="post" action="{% url 'cart_add' product.pk %}">
                        {% csrf_token %}
                        {{form_cart}}
                        <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
                    </form>
                {%endif%}
            </div>
        </div>
        <hr>
        <h2 class="mb-4">–û—Ç–∑—ã–≤—ã</h2>
        {% for review in product.reviews.all %}
            <div class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title">{{ review.customer.username }} <span class="badge bg-warning text-dark">{{ review.rating }} ‚òÖ</span></h5>
                    <p class="card-text">{{ review.comment|default:"–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è" }}</p>
                    <p class="card-text"><small class="text-muted">{{ review.created_at|date:"d.m.Y H:i" }}</small></p>
                </div>
            </div>
        {% empty %}
            <p>–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç üòî</p>
        {% endfor %}
        {% if user.is_authenticated %}
            <h3 class="mb-3">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
            <form method="POST" class="mb-4">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="rating" class="form-label">–†–µ–π—Ç–∏–Ω–≥</label>
                    <select class="form-select" name="rating" id="rating" required>
                        {% for i in "12345" %}
                            <option value="{{ i }}">{{ i }} ‚òÖ</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="mb-3">
                    <label for="comment" class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <textarea class="form-control" name="comment" id="comment" rows="4"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
            </form>
        {% else %}
            <p><a href="{% url 'login_page' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤.</p>
        {% endif %}
    </div>
{% endblock %}